@prefix : <https://biomedit.ch/rdf/sphn-ontology/spo#> .
@prefix constraints: <https://biomedit.ch/rdf/sphn-ontology-constraints/sphn#> .
@prefix ns1: <http://purl.org/dc/terms/> .
@prefix ns2: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix sphn: <https://biomedit.ch/rdf/sphn-ontology/sphn#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix snomed:      <http://snomed.info/id/> .

constraints: a ns2:Ontology ;
    ns1:created "2021-11-04"^^xsd:date ;
    ns1:license <https://creativecommons.org/licenses/by-nc-sa/4.0/> ;
    rdfs:comment "Generated by the the SHACLer tool, that is developed by the SPHN DCC (PHI, SIB Swiss Institute of Bioinformatics)."^^xsd:string ;
    ns2:versionIRI <https://biomedit.ch/rdf/sphn-ontology/spo/2021/1> ;
    sh:entailment <http://www.w3.org/ns/entailment/RDFS> .

constraints:DissociationResponseVS a sh:NodeShape ;
    sh:closed false ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:in ( :yes :no sphn:Unknown ) ;
            sh:path [ sh:inversePath rdf:type ] ] ;
    sh:targetClass :DissociationResponseVS .

constraints:FollowUpEvent a sh:NodeShape ;
    sh:closed false ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:datatype xsd:dateTime ;
            sh:maxCount 1 ;
            sh:minCount 0 ; # ko on HUG TU with 1
            sh:path :hasDateTime ],
        [ sh:class sphn:DataProviderInstitute ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasDataProviderInstitute ],
        [ sh:maxCount 1 ;
          sh:minCount 1 ;
          sh:or       ( [ sh:class snomed:399307001 ] [ sh:class snomed:438949009 ] [ sh:class snomed:419099009 ] [ sh:class snomed:261665006 ] [ sh:class snomed:74964007 ] ) ;
          sh:path     :hasFollowUpEventEvent ],
        [ sh:class sphn:AdministrativeCase ;
            sh:maxCount 1 ;
            sh:minCount 0 ;
            sh:path :hasAdministrativeCase ],
        [ sh:datatype xsd:dateTime ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasFollowUpEventDateTime ],
        [ sh:class sphn:SubjectPseudoIdentifier ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasSubjectPseudoIdentifier ] ;
    sh:targetClass :FollowUpEvent .

constraints:LowConfidenceVs a sh:NodeShape ;
    sh:closed false ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:in ( :yes :no sphn:Unknown ) ;
            sh:path [ sh:inversePath rdf:type ] ] ;
    sh:targetClass :LowConfidenceVs .

constraints:OncologyDiagnosis a sh:NodeShape ;
    sh:closed false ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:class <https://biomedit.ch/rdf/sphn-resource/onco-tree#OncoTree> ;
            sh:path :hasOncologyDiagnosisOncoTreeClassificationCode ],
        [ sh:datatype xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 0 ;
            sh:path :hasOncologyDiagnosisFreeTextDiagnosis ],
        [ sh:datatype xsd:dateTime ;
            sh:maxCount 1 ;
            sh:minCount 0 ; # ko on HUG TU with 1
            sh:path :hasDateTime ],
        [ sh:class sphn:SubjectPseudoIdentifier ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasSubjectPseudoIdentifier ],
        [ sh:datatype xsd:dateTime ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasOncologyDiagnosisFirstDateTime ],
        [ sh:class sphn:ICDODiagnosis ;
            sh:maxCount 1 ;
            sh:minCount 0 ;
            sh:path :hasIcdODiagnosis ],
        [ sh:class sphn:AdministrativeCase ;
            sh:maxCount 1 ;
            sh:minCount 0 ;
            sh:path :hasAdministrativeCase ],
        [ sh:maxCount 1 ;
          sh:minCount 0 ;
          sh:or       ( [ sh:class snomed:7771000 ] [ sh:class snomed:51440002 ] [ sh:class snomed:24028007 ] [ sh:class snomed:399488007 ] [ sh:class snomed:66459002 ] ) ;
          sh:path     :hasOncologyDiagnosisLaterality ],
        [ sh:class sphn:DataProviderInstitute ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasDataProviderInstitute ],
        [ sh:class <https://biomedit.ch/rdf/sphn-resource/icd-10-gm/ICD-10-GM> ;
            sh:path :hasOncologyDiagnosisIcdCode ],
        [ sh:maxCount 1 ; # HUG - SPO reversed :D
          sh:minCount 0 ;
          sh:or       ( [ sh:class snomed:7771000 ] [ sh:class snomed:51440002 ] [ sh:class snomed:24028007 ] [ sh:class snomed:399488007 ] [ sh:class snomed:66459002 ] ) ;
          sh:path     :hasLaterality ] ;
    sh:targetClass :OncologyDiagnosis .

constraints:OncologyDrugTreatment a sh:NodeShape ;
    sh:closed false ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:class sphn:DrugAdministrationEvent ;
            sh:path :hasDrugAdministrationEvent ],
        [ sh:class sphn:Intent ;
            sh:path :hasTreatmentIntent ],
        [ sh:class sphn:DataProviderInstitute ;
            sh:maxCount 1 ;
            sh:minCount 0 ;
            sh:path :hasDataProviderInstitute ],
        [ sh:class sphn:SubjectPseudoIdentifier ;
            sh:maxCount 1 ;
            sh:minCount 0 ;
            sh:path :hasSubjectPseudoIdentifier ],
        [ sh:class :RelativeDoseOfDrugApplied ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasOncologyDrugTreatmentRelativeDoseOfDrugApplied ],
        [ sh:class sphn:AdministrativeCase ;
            sh:maxCount 1 ;
            sh:minCount 0 ;
            sh:path :hasAdministrativeCase ] ;
    sh:targetClass :OncologyDrugTreatment .

constraints:OncologySurgery a sh:NodeShape ;
    sh:closed false ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:class sphn:FOPHProcedure ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasOncologySurgeryFophProcedure ],
        [ sh:class sphn:Intent ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasSurgeryIntent ] ;
    sh:targetClass :OncologySurgery .

constraints:RadiologyReport a sh:NodeShape ;
    sh:closed false ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:datatype xsd:dateTime ;
            sh:maxCount 1 ;
            sh:minCount 0 ; # ko on HUG TU with 1
            sh:path :hasDateTime ],
        [ sh:maxCount 2 ;
          sh:minCount 1 ;
          sh:or       ( [ sh:class snomed:113091000 ] [ sh:class snomed:16310003 ] [ sh:class snomed:82918005 ] [ sh:class snomed:363680008 ] [ sh:class snomed:450436003 ] [ sh:class snomed:77477000 ] ) ;
          sh:path     :hasRadiologyReportMethod ],
        [ sh:datatype xsd:dateTime ;
            sh:path :hasRadiologyReportDateTime ],
        [ sh:class sphn:SubjectPseudoIdentifier ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasSubjectPseudoIdentifier ],
        [ sh:class sphn:AdministrativeCase ;
            sh:maxCount 1 ;
            sh:minCount 0 ;
            sh:path :hasAdministrativeCase ],
        [ sh:class sphn:DataProviderInstitute ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasDataProviderInstitute ],
        [ sh:datatype xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasRadiologyReportConclusion ] ;
    sh:targetClass :RadiologyReport .

constraints:RegimenComponent a sh:NodeShape ;
    sh:closed false ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:class sphn:AdministrativeCase ;
            sh:maxCount 1 ;
            sh:minCount 0 ;
            sh:path :hasAdministrativeCase ],
                [ sh:class sphn:Drug ;
            sh:minCount 1 ;
            sh:path :hasRegimenComponentDrug ],
                [ sh:class sphn:DataProviderInstitute ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasDataProviderInstitute ],
                [ sh:class sphn:SubstanceAmount ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasRegimenComponentDosage ],
                [ sh:class sphn:SubjectPseudoIdentifier ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasSubjectPseudoIdentifier ],
                [ sh:datatype xsd:integer ;
            sh:minCount 1 ;
            sh:path :hasRegimenComponentScheduleOfAdministration ], [ sh:class snomed:284009009 ;
                                                                      sh:path  :hasRegimenComponentAdministrationRouteCode ] ;
    sh:targetClass :RegimenComponent .

constraints:RelativeDoseOfDrugApplied a sh:NodeShape ;
    sh:closed false ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:class sphn:SubjectPseudoIdentifier ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasSubjectPseudoIdentifier ],
        [ sh:class sphn:DataProviderInstitute ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasDataProviderInstitute ],
        [ sh:class sphn:AdministrativeCase ;
            sh:maxCount 1 ;
            sh:minCount 0 ;
            sh:path :hasAdministrativeCase ],
        [ sh:class sphn:Unit ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasRelativeDoseOfDrugAppliedUnit ] ;
    sh:targetClass :RelativeDoseOfDrugApplied .

constraints:SomaticVariantFound a sh:NodeShape ;
    sh:closed false ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:datatype xsd:string ;
            sh:maxCount 1 ;
            sh:path :hasSomaticVariantFoundHGVSP ],
        [ sh:class sphn:DataProviderInstitute ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasDataProviderInstitute ],
        [ sh:datatype xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasSomaticVariantFoundProteinName ],
        [ sh:datatype xsd:string ;
            sh:maxCount 1 ;
            sh:path :hasSomaticVariantFoundHGVSC ],
        [ sh:datatype xsd:string ;
            sh:maxCount 1 ;
            sh:path :hasSomaticVariantFoundTestDescription ],
        [ sh:datatype xsd:dateTime ;
            sh:maxCount 1 ;
            sh:minCount 0 ; # ko on HUG TU with 1
            sh:path :hasDateTime ],
        [ sh:class sphn:AdministrativeCase ;
            sh:maxCount 1 ;
            sh:minCount 0 ;
            sh:path :hasAdministrativeCase ],
        [ sh:datatype xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasSomaticVariantFoundGeneName ],
        [ sh:datatype xsd:dateTime ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasSomaticVariantFoundDateTime ],
        [ sh:class sphn:SubjectPseudoIdentifier ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasSubjectPseudoIdentifier ] ;
    sh:targetClass :SomaticVariantFound .

constraints:TreatmentCycle a sh:NodeShape ;
    sh:closed false ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:class :RegimenComponent ;
            sh:path :hasTreatmentCycleRegimenComponent ],
        [ sh:datatype xsd:dateTime ; # HUG typo xsd:string ???
            sh:path :hasTreatmentCycleStartDateTime ],
        [ sh:class sphn:DataProviderInstitute ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasDataProviderInstitute ],
        [ sh:class sphn:AdministrativeCase ;
            sh:maxCount 1 ;
            sh:minCount 0 ;
            sh:path :hasAdministrativeCase ],
        [ sh:datatype xsd:integer ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasTreatmentCycleNumber ],
        [ sh:datatype xsd:string ;
            sh:maxCount 1 ;
            sh:minCount 0 ;
            sh:path :hasTreatmentCycleRegimenAcronym ],
        [ sh:datatype xsd:dateTime ;
            sh:path :hasTreatmentCycleEndDateTime ],
        [ sh:datatype xsd:dateTime ;
            sh:maxCount 1 ;
            sh:minCount 0 ; # ko on HUG TU with 1
            sh:path :hasDateTime ],
        [ sh:class sphn:SubjectPseudoIdentifier ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasSubjectPseudoIdentifier ] ;
    sh:targetClass :TreatmentCycle .

constraints:sphnOncologyTreatmentAssessment a sh:NodeShape ;
    sh:closed false ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:datatype xsd:string ;
            sh:path :hasOncologyTreatmentAssessmentAnnotator ],
        [ sh:maxCount 1 ;
          sh:minCount 1 ;
          sh:or       ( [ sh:class snomed:58147004 ] [ sh:class snomed:260413007 ] [ sh:class snomed:5526005 ] [ sh:class snomed:80534008 ] [ sh:class snomed:261665006 ] [ sh:class snomed:74964007 ] ) ;
          sh:path     :hasOncologyTreatmentAssessmentAssessmentType ],
        [ sh:class :LowConfidenceVs ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasOncologyTreatmentAssessmentLowConfidence ],
        [ sh:class :DissociationResponseVS ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasOncologyTreatmentAssessmentDissociationResponse ],
        [ sh:class :RadiologyReport ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasOncologyTreatmentAssessmentRadiologyReport ],
        [ sh:class sphn:DataProviderInstitute ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasDataProviderInstitute ] ;
    sh:targetClass sphn:OncologyTreatmentAssessment .

constraints:sphnTumorSpecimen a sh:NodeShape ;
    sh:closed false ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property [ sh:class sphn:DataProviderInstitute ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path :hasDataProviderInstitute ],
        [ sh:maxCount 1 ;
          sh:minCount 0 ;
          sh:or       ( [ sh:class snomed:7771000 ] [ sh:class snomed:51440002 ] [ sh:class snomed:24028007 ] [ sh:class snomed:399488007 ] [ sh:class snomed:66459002 ] ) ;
          sh:path     :hasTumorSpecimenLaterality ],
        [ sh:maxCount 1 ; # HUG - SPO reversed :D
          sh:minCount 0 ;
          sh:or       ( [ sh:class snomed:7771000 ] [ sh:class snomed:51440002 ] [ sh:class snomed:24028007 ] [ sh:class snomed:399488007 ] [ sh:class snomed:66459002 ] ) ;
          sh:path     :hasLaterality ] ;
    sh:targetClass sphn:TumorSpecimen .

